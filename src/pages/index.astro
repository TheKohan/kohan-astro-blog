---
import LandingPage from "@layouts/landing-page.astro";
import { getCollection } from "astro:content";
import { DateTime } from "luxon";
import CldImage from "@components/cld-image.astro";

const postsCollection = (await getCollection("posts")).sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime()
);

const latestPosts = postsCollection.slice(0, 6);
---

<LandingPage title="Home">
  <div
    class="mb-8 flex flex-col gap-4 rounded-2xl bg-slate-300 p-4 dark:bg-slate-800 sm:flex-row sm:p-8"
  >
    <div class="flex flex-shrink-0 flex-grow-0 justify-center rounded-full">
      <div>
        <CldImage
          alt="Profile"
          width={150}
          class="h-24 w-24 rounded-full border-4 border-kohan-800 dark:border-kohan-500 md:h-32 md:w-32"
          height={150}
          src="kohan-avatar"
        />
      </div>
    </div>
    <div class="flex flex-col gap-1">
      <h1 class="text-3xl font-bold text-slate-900 dark:text-kohan-500">
        About me
      </h1>
      <p>
        Hi my name is <span class="font-bold text-slate-900 dark:text-kohan-500"
          >Piotr Kochanowski</span
        > and i'm a passionate Web developer from Poland. In love with TypeScript
        and static types. Currently working as a Frontend developer at <span
          class="font-bold text-slate-900 dark:text-kohan-500">VirtusLab</span
        >.
      </p>
    </div>
  </div>
  <div
    class="mb-4 flex flex-col divide-y-2 divide-kohan-800 dark:divide-kohan-500"
  >
    <h2 class="pb-2 text-2xl dark:text-kohan-500">Latest articles</h2>
    <div class="grid grid-cols-1 gap-8 pt-4 sm:grid-cols-2 md:grid-cols-3">
      {
        latestPosts.map((post) => (
          <a class="items-top flex gap-4" href={"/posts/" + post.slug}>
            <CldImage
              class={"h-16 w-16 rounded-2xl object-cover"}
              width={75}
              height={75}
              alt={post.data.image.alt}
              src={post.data.image.src}
            />
            <div class="flex flex-col gap-2">
              <h3 class="dark:text-kohan-500 text-xl">{post.data.title}</h3>
              <p class="dark:text-kohan-800 text-sm">
                {DateTime.fromJSDate(post.data.publishDate).toFormat(
                  "MMM dd, yyyy"
                )}
              </p>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</LandingPage>
